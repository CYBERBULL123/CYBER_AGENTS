from fastapi import APIRouter

router = APIRouter()

class SystemScanner:
    def __init__(self):
        self.known_vulnerabilities = [
            {"id": "CVE-2023-1234", "description": "Outdated software X"},
            {"id": "CVE-2023-5678", "description": "Weak password policy"},
        ]

    def scan_system(self):
        # Simulate a system scan
        return {"vulnerabilities": self.known_vulnerabilities}

scanner = SystemScanner()

@router.get("/scan")
async def scan():
    return scanner.scan_system()